create database kimthanhdat
use kimthanhdat
DROP TABLE IF EXISTS SANPHAM
DROP TABLE IF EXISTS CONGNHAN
DROP TABLE IF EXISTS CHAMCONG
DROP TABLE IF EXISTS CHITIET
create table CONGNHAN
(
	MACN char(6) not null,
	HOTEN nvarchar(50) not null,
	PX int not null,
	Primary key (MACN)
)

CREATE TABLE SANPHAM
(
	MASP CHAR(6) NOT NULL,
	TENSP nvarchar(50) not null,
	DONGIA INT NOT NULL,
	PRIMARY KEY (MASP)
)

CREATE TABLE CHAMCONG
(
	MACC INT NOT NULL,
	NGAY DATE NOT NULL,
	MACN CHAR(6) NOT NULL,
	PRIMARY KEY (MACC)
)

CREATE TABLE CHITIET
(
	MACC INT NOT NULL,
	MASP CHAR(6) NOT NULL,
	SOSP INT NOT NULL,
	SOPP INT NOT NULL,
	PRIMARY KEY (MACC, MASP),
	FOREIGN KEY (MACC) REFERENCES CHAMCONG(MACC),
	FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP)
)

INSERT CONGNHAN(MACN,HOTEN,PX)
VALUES ('CN01','KIM THANH DAT',2)
INSERT CONGNHAN(MACN,HOTEN,PX)
VALUES ('CN02','TRAN MANH HUNG',1)
INSERT CONGNHAN(MACN,HOTEN,PX)
VALUES ('CN03','NGUYEN TUAN DUNG',2)
INSERT CONGNHAN(MACN,HOTEN,PX)
VALUES ('CN04','DAO MINH QUAN',1) 
INSERT CONGNHAN(MACN,HOTEN,PX)
VALUES ('CN05','TRAN HOAI TUAN',2)

INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KV','KEM VINAMIL',2200)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KA','KEM CAY',1400)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KX','KEM XOAI',3000)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KK','KEM KG',2700)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KR','KEM SAU RIENG',4000)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KC','KEM CAM',1750)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KM','KEM MIT',2700)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KT','KEM TAO',3500)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KD','KEM DUA',2450)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KS','KEM SUA',1900)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KL','KEM KHOAI LANG',5000)
INSERT SANPHAM(MASP,TENSP,DONGIA)
VALUES ('KE','KEM TRUNG',6000)




INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('01','01/01/2020','CN01')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('02','01/02/2020','CN02')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('03','01/03/2020','CN03')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('04','01/04/2020','CN04')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('05','01/05/2020','CN05')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('06','01/06/2020','CN01')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('07','01/07/2020','CN02')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('08','01/08/2020','CN03')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('09','01/09/2020','CN04')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('10','01/10/2020','CN05')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('11','01/11/2020','CN01')
INSERT CHAMCONG(MACC,NGAY,MACN)
VALUES ('12','01/12/2020','CN02')

INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('01','KV',200,5)
INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('02','KV',150,7)
INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('03','KL',210,5)
INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('04','KX',225,5)
INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('05','KE',250,5)
INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('06','KE',150,5)
INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('07','KE',200,5)
INSERT CHITIET(MACC,MASP,SOSP,SOPP)
VALUES ('08','KD',110,5)



SELECT * FROM CONGNHAN
WHERE HOTEN LIKE 'Tran%' and PX = '2'

SELECT * FROM SANPHAM
WHERE DONGIA >= 2000 AND DONGIA <= 200000
ORDER BY DONGIA DESC

SELECT SUM(SOSP) AS 'TONG SP KEM VINAMIL' FROM CHITIET
WHERE MASP = 'KV'





